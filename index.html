<!---
    CIT 140 Programming Project 5
--->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>students by major</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.1.2/handlebars.min.js"></script>
  </head>
  <body>
    <h2>Select a Major</h2>
    <form>
      <button type="button" id="show_cit">CIT Majors</button>
      <button type="button" id="show_bus">Buisness Majors</button>
    </form>
    <h3>We filter our dataset by major</h3>
    <div id="people_table"></div>
  </body>
  <script type="text/x-handlebars-template" id="table_template"> <table cellspacing='12'>
				<tr>
					<th>Name</th>
					<th>Major</th>
					<th>Midterm</th>
					<th>Final</th>
				</tr>
       {{#each rows}}
            
				<tr>
					<td>{{name}}</td>
					<td>{{major}}</td>
					<td>{{midterm}}</td>
					<td>{{final}}</td>
				</tr>
       {{/each}}
   
			</table>
		</script>
  <script>
    document.getElementById('show_cit').onclick = async function() {
      var url = "cit5students.json";
      var response = await fetch(url);
      var cit_students=[];
      if (response.ok) {
        var data = await response.json();
        for (const student of data) {
          if (student.major === 'CIT') {
            cit_students.push(student);
          }
        }
        var template_text = document.getElementById('table_template').innerHTML;
        var compiled_template_text = Handlebars.compile(template_text);
        compiled_html = compiled_template_text({
          rows: cit_students
        })
        document.getElementById('people_table').innerHTML = compiled_html;
      } else {
        document.querySelector('#people_table').innerHTML = "Data not found";
      }
    }
    document.getElementById('show_bus').onclick = async function() {
      var url = "cit5students.json";
      var response = await fetch(url);
      var bus_students=[];
      if (response.ok) {
        var data = await response.json();
        for (const student of data) {
          if (student.major === 'BUS') {
            bus_students.push(student);
          }
        }
        var template_text = document.getElementById('table_template').innerHTML;
        var compiled_template_text = Handlebars.compile(template_text);
        compiled_html = compiled_template_text({
          rows: cit_students
        })
        document.getElementById('people_table').innerHTML = compiled_html;
      } else {
        document.querySelector('#people_table').innerHTML = "Data not found";
      }
    }
  </script>
</html>